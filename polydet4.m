% Expresses the determinant of a 4x4 mtarix as a polynomial.
%
% Consider the matrix B - r*A. Its determinant is a 4th degree polynomial.
% A:
% B:
%
% p:

function p = polydet4( A, B)

  % Allocate space
  p = zeros(1, 5);

  % Coefficient for r^4.
  p(1) = det(A);

  % Coefficient for r^3.
  U1 = [[A(1,1), A(1,2), A(1,3), A(1,4)]; ...
        [A(2,1), A(2,2), A(2,3), A(2,4)]; ...
        [A(3,1), A(3,2), A(3,3), A(3,4)]; ...
        [B(4,1), B(4,2), B(4,3), B(4,4)]];

  U2 = [[A(1,1), A(1,2), A(1,3), A(1,4)]; ...
        [A(2,1), A(2,2), A(2,3), A(2,4)]; ...
        [B(3,1), B(3,2), B(3,3), B(3,4)]; ...
        [A(4,1), A(4,2), A(4,3), A(4,4)]];

  U3 = [[A(1,1), A(1,2), A(1,3), A(1,4)]; ...
        [B(2,1), B(2,2), B(2,3), B(2,4)]; ...
        [A(3,1), A(3,2), A(3,3), A(3,4)]; ...
        [A(4,1), A(4,2), A(4,3), A(4,4)]];

  U4 = [[B(1,1), B(1,2), B(1,3), B(1,4)]; ...
        [A(2,1), A(2,2), A(2,3), A(2,4)]; ...
        [A(3,1), A(3,2), A(3,3), A(3,4)]; ...
        [A(4,1), A(4,2), A(4,3), A(4,4)]];

  p(2) = - det(U1) - det(U2) - det(U3) - det(U4);

  % Coefficient for r^2.
  V1 = [[A(1,1), A(1,2), A(1,3), A(1,4)]; ...
        [A(2,1), A(2,2), A(2,3), A(2,4)]; ...
        [B(3,1), B(3,2), B(3,3), B(3,4)]; ...
        [B(4,1), B(4,2), B(4,3), B(4,4)]];

  V2 = [[A(1,1), A(1,2), A(1,3), A(1,4)]; ...
        [B(2,1), B(2,2), B(2,3), B(2,4)]; ...
        [A(3,1), A(3,2), A(3,3), A(3,4)]; ...
        [B(4,1), B(4,2), B(4,3), B(4,4)]];

  V3 = [[A(1,1), A(1,2), A(1,3), A(1,4)]; ...
        [B(2,1), B(2,2), B(2,3), B(2,4)]; ...
        [B(3,1), B(3,2), B(3,3), B(3,4)]; ...
        [A(4,1), A(4,2), A(4,3), A(4,4)]];

  V4 = [[B(1,1), B(1,2), B(1,3), B(1,4)]; ...
        [A(2,1), A(2,2), A(2,3), A(2,4)]; ...
        [A(3,1), A(3,2), A(3,3), A(3,4)]; ...
        [B(4,1), B(4,2), B(4,3), B(4,4)]];

  V5 = [[B(1,1), B(1,2), B(1,3), B(1,4)]; ...
        [A(2,1), A(2,2), A(2,3), A(2,4)]; ...
        [B(3,1), B(3,2), B(3,3), B(3,4)]; ...
        [A(4,1), A(4,2), A(4,3), A(4,4)]];

  V6 = [[B(1,1), B(1,2), B(1,3), B(1,4)]; ...
        [B(2,1), B(2,2), B(2,3), B(2,4)]; ...
        [A(3,1), A(3,2), A(3,3), A(3,4)]; ...
        [A(4,1), A(4,2), A(4,3), A(4,4)]];

  p(3) = det(V1) + det(V2) + det(V3) + det(V4) + det(V5) + det(V6);

  % Coefficient for r.
  X1 = [[A(1,1), A(1,2), A(1,3), A(1,4)]; ...
        [B(2,1), B(2,2), B(2,3), B(2,4)]; ...
        [B(3,1), B(3,2), B(3,3), B(3,4)]; ...
        [B(4,1), B(4,2), B(4,3), B(4,4)]];

  X2 = [[B(1,1), B(1,2), A(1,3), B(1,4)]; ...
        [A(2,1), A(2,2), A(2,3), A(2,4)]; ...
        [B(3,1), B(3,2), B(3,3), B(3,4)]; ...
        [B(4,1), B(4,2), B(4,3), B(4,4)]];

  X3 = [[B(1,1), B(1,2), B(1,3), B(1,4)]; ...
        [B(2,1), B(2,2), B(2,3), B(2,4)]; ...
        [A(3,1), A(3,2), A(3,3), A(3,4)]; ...
        [B(4,1), B(4,2), B(4,3), B(4,4)]];

  X4 = [[B(1,1), B(1,2), B(1,3), B(1,4)]; ...
        [B(2,1), B(2,2), B(2,3), B(2,4)]; ...
        [B(3,1), B(3,2), B(3,3), B(3,4)]; ...
        [A(4,1), A(4,2), A(4,3), A(4,4)]];

  p(4) = - det(X1) - det(X2) - det(X3) - det(X4);

  % Constant term.
  p(5) = det(B);

end
